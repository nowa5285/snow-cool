<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Advanced Summer Pool Scene</title>
    <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
    <script>
      AFRAME.registerComponent('coconut-fall', {
        schema: {
          interval: { type: 'number', default: 5200 },
          height: { type: 'number', default: 6.4 }
        },
        init: function () {
          this.coconuts = [];
          for (let i = 0; i < 3; i++) {
            const c = document.createElement('a-sphere');
            c.setAttribute('radius', '0.11');
            c.setAttribute('color', '#5E3A20');
            c.setAttribute('shadow', 'cast: true; receive: false');
            this.el.appendChild(c);
            this.coconuts.push(c);
          }
          this.dropBatch();
        },
        dropBatch: function () {
          const h = this.data.height;
          this.coconuts.forEach((c, i) => {
            const xoff = (Math.random() - 0.5) * 0.5;
            const zoff = (Math.random() - 0.5) * 0.5;
            c.setAttribute('position', `${xoff} ${h} ${zoff}`);
            c.setAttribute('visible', true);
            c.setAttribute(`animation__fall${i}`, {
              property: 'position',
              to: `${xoff} 0 ${zoff}`,
              dur: 1400 + i * 200,
              easing: 'easeInQuad'
            });
            setTimeout(() => {
              c.setAttribute('visible', false);
            }, 1700 + i * 200);
          });
          setTimeout(() => this.dropBatch(), this.data.interval);
        }
      });

      AFRAME.registerComponent('bird-flight', {
        schema: {
          fromX: {default: -7},
          toX: {default: 7},
          y: {default: 5},
          z: {default: -14},
          dur: {default: 9000}
        },
        init: function () {
          const d = this.data;
          this.el.setAttribute('position', `${d.fromX} ${d.y} ${d.z}`);
          this.el.setAttribute('animation__fly', {
            property: 'position',
            from: `${d.fromX} ${d.y} ${d.z}`,
            to: `${d.toX} ${d.y} ${d.z}`,
            dir: 'alternate',
            loop: true,
            dur: d.dur,
            easing: 'linear'
          });
        }
      });

      AFRAME.registerComponent('cloud-drift', {
        schema: { dist: {default: 6}, dur: {default: 16000} },
        init: function () {
          const p = this.el.getAttribute('position');
          this.el.setAttribute('animation__cloud', {
            property: 'position',
            from: `${p.x - this.data.dist} ${p.y} ${p.z}`,
            to: `${p.x + this.data.dist} ${p.y} ${p.z}`,
            dir: 'alternate',
            loop: true,
            dur: this.data.dur,
            easing: 'linear'
          });
        }
      });
    </script>
  </head>
  <body>
    <a-scene shadow="type: pcfsoft" renderer="colorManagement: true">
      <a-assets>
        <img id="summer-sky" src="assets/cool-sky-edited.jpg">
        <!-- ground texture -->
        <img id="concrete" src="assets/grunge-wall-texture.jpg">
        <!-- spinning cube texture -->
        <img id="minecraft" src="assets/woop.jpg">
      </a-assets>

      <a-sky src="#summer-sky"></a-sky>

      <!-- main lights -->
      <a-entity light="type: directional; intensity: 0.85; castShadow: true" position="3 7 -5"></a-entity>
      <a-entity light="type: hemisphere; intensity: 0.35; color: #ffffff; groundColor: #ffe1b5"></a-entity>

      <!-- sun higher and glowing -->
      <a-sphere position="6 10 -12"
                radius="0.95"
                color="#FFD166"
                material="emissive: #FFD166; emissiveIntensity: 1.4"
                animation="property: position; to: 4 10 -10; dir: alternate; loop: true; dur: 9000; easing: easeInOutSine">
      </a-sphere>
      <a-entity light="type: point; intensity: 0.9; distance: 12; color: #FFD166" position="6 10 -12"></a-entity>

      <!-- ground with texture -->
      <a-plane position="0 0 -6"
               rotation="-90 0 0"
               width="18"
               height="16"
               src="#concrete"
               repeat="4 4"
               shadow="receive: true">
      </a-plane>

      <!-- pool base -->
      <a-box position="3 0.3 -10"
             depth="4.5"
             height="0.6"
             width="5.2"
             color="#E5F3FF"
             shadow="cast: true; receive: true">
      </a-box>

      <!-- pool water -->
      <a-plane position="3 0.61 -10"
               rotation="-90 0 0"
               width="4.7"
               height="3.9"
               color="#4BB5FF"
               opacity="0.9"
               shadow="receive: true">
      </a-plane>

      <!-- flamingo floaty in pool -->
      <a-entity position="3 0.68 -10"
                animation__bob="property: position; dir: alternate; to: 3 0.76 -10; loop: true; dur: 2100; easing: easeInOutSine">
        <a-torus radius="0.6"
                 radius-tubular="0.13"
                 rotation="90 0 0"
                 color="#FF80B5"
                 shadow="cast: true">
        </a-torus>
        <a-cylinder position="0 0.35 0.35"
                    radius="0.08"
                    height="0.5"
                    rotation="-35 0 0"
                    color="#FF80B5"
                    shadow="cast: true">
        </a-cylinder>
        <a-sphere position="0 0.6 0.6" radius="0.14" color="#FF80B5" shadow="cast: true"></a-sphere>
        <a-cone position="0 0.58 0.74"
                radius-bottom="0.05"
                radius-top="0.01"
                height="0.12"
                rotation="-20 0 0"
                color="#000">
        </a-cone>
        <a-sphere position="0.05 0.65 0.58" radius="0.015" color="#fff"></a-sphere>
        <a-sphere position="-0.05 0.65 0.58" radius="0.015" color="#fff"></a-sphere>
      </a-entity>

      <!-- tall palm 1 -->
      <a-entity position="-3 0 -7" coconut-fall="interval: 5200; height: 6.4">
        <a-cylinder position="0 3.3 0" radius="0.19" height="6.6" color="#8B5A2B" shadow="cast: true"></a-cylinder>
        <a-cone position="0 6.4 0" radius-bottom="0.15" radius-top="0.01" height="2.6" rotation="-35 0 0" color="#3FAF3F" shadow="cast: true"></a-cone>
        <a-cone position="0 6.4 0" radius-bottom="0.15" radius-top="0.01" height="2.5" rotation="-32 45 0" color="#358F3A" shadow="cast: true"></a-cone>
        <a-cone position="0 6.4 0" radius-bottom="0.15" radius-top="0.01" height="2.4" rotation="-30 90 0" color="#3FAF3F" shadow="cast: true"></a-cone>
        <a-cone position="0 6.4 0" radius-bottom="0.15" radius-top="0.01" height="2.7" rotation="-38 135 0" color="#358F3A" shadow="cast: true"></a-cone>
        <a-cone position="0 6.4 0" radius-bottom="0.15" radius-top="0.01" height="2.5" rotation="-33 180 0" color="#3FAF3F" shadow="cast: true"></a-cone>
        <a-cone position="0 6.4 0" radius-bottom="0.15" radius-top="0.01" height="2.4" rotation="-31 225 0" color="#358F3A" shadow="cast: true"></a-cone>
        <a-cone position="0 6.4 0" radius-bottom="0.15" radius-top="0.01" height="2.6" rotation="-36 270 0" color="#3FAF3F" shadow="cast: true"></a-cone>
        <a-cone position="0 6.4 0" radius-bottom="0.15" radius-top="0.01" height="2.5" rotation="-34 315 0" color="#358F3A" shadow="cast: true"></a-cone>
      </a-entity>

      <!-- tall palm 2 -->
      <a-entity position="3 0 -5" rotation="0 20 0">
        <a-cylinder position="0 3.1 0" radius="0.17" height="6.2" color="#8B5A2B" shadow="cast: true"></a-cylinder>
        <a-cone position="0 6.1 0" radius-bottom="0.14" radius-top="0.01" height="2.3" rotation="-30 15 0" color="#46B952" shadow="cast: true"></a-cone>
        <a-cone position="0 6.1 0" radius-bottom="0.14" radius-top="0.01" height="2.4" rotation="-33 65 0" color="#3FAF3F" shadow="cast: true"></a-cone>
        <a-cone position="0 6.1 0" radius-bottom="0.14" radius-top="0.01" height="2.2" rotation="-29 120 0" color="#46B952" shadow="cast: true"></a-cone>
        <a-cone position="0 6.1 0" radius-bottom="0.14" radius-top="0.01" height="2.6" rotation="-36 170 0" color="#3FAF3F" shadow="cast: true"></a-cone>
        <a-cone position="0 6.1 0" radius-bottom="0.14" radius-top="0.01" height="2.4" rotation="-32 225 0" color="#46B952" shadow="cast: true"></a-cone>
        <a-cone position="0 6.1 0" radius-bottom="0.14" radius-top="0.01" height="2.5" rotation="-34 280 0" color="#3FAF3F" shadow="cast: true"></a-cone>
      </a-entity>

      <!-- umbrella + advanced sun chair -->
      <a-entity position="0 0 -6.5" shadow="cast: true">
        <a-cylinder position="0 1 0" radius="0.05" height="2" color="#FFFFFF" shadow="cast: true"></a-cylinder>
        <a-cone position="0 2 0" radius-bottom="1.4" radius-top="0.05" height="1" color="#FF7070" shadow="cast: true"></a-cone>
        <a-cone position="0 1.95 0" radius-bottom="1.2" radius-top="0.05" height="0.8" color="#FFD166" shadow="cast: true"></a-cone>

        <!-- legs -->
        <a-box position="1.5 0.25 0.1" width="0.07" height="0.5" depth="0.07" color="#D4D4D4" shadow="cast: true"></a-box>
        <a-box position="1.1 0.25 0.1" width="0.07" height="0.5" depth="0.07" color="#D4D4D4" shadow="cast: true"></a-box>
        <a-box position="1.65 0.18 0.55" width="0.07" height="0.35" depth="0.07" color="#D4D4D4" shadow="cast: true"></a-box>
        <a-box position="1.15 0.18 0.55" width="0.07" height="0.35" depth="0.07" color="#D4D4D4" shadow="cast: true"></a-box>

        <!-- frame bar -->
        <a-box position="1.4 0.42 0.35" width="0.6" height="0.06" depth="0.06" color="#C7C7C7" shadow="cast: true"></a-box>

        <!-- seat -->
        <a-box position="1.4 0.48 0.4"
               width="1.0"
               height="0.05"
               depth="0.55"
               rotation="-18 0 0"
               color="#F2F2F2"
               shadow="cast: true"></a-box>

        <!-- back -->
        <a-box position="1.75 0.85 0.05"
               width="0.9"
               height="0.05"
               depth="0.6"
               rotation="-38 0 0"
               color="#EFEFEF"
               shadow="cast: true"></a-box>

        <!-- fabric seat -->
        <a-box position="1.4 0.5 0.4"
               width="0.9"
               height="0.015"
               depth="0.5"
               rotation="-18 0 0"
               color="#8EC5FC"
               shadow="cast: false"></a-box>

        <!-- fabric back -->
        <a-box position="1.75 0.87 0.03"
               width="0.8"
               height="0.015"
               depth="0.52"
               rotation="-38 0 0"
               color="#8EC5FC"
               shadow="cast: false"></a-box>
      </a-entity>

      <!-- clouds -->
      <a-entity position="-7 5 -11" cloud-drift="dist: 5; dur: 16000">
        <a-sphere position="0 0 0" radius="1.1" color="#F0F0F0" opacity="0.9"></a-sphere>
        <a-sphere position="1 0.2 0.2" radius="0.9" color="#E7E7E7" opacity="0.9"></a-sphere>
        <a-sphere position="-0.9 0.1 -0.2" radius="0.8" color="#ECECEC" opacity="0.9"></a-sphere>
      </a-entity>
      <a-entity position="6.5 4.5 -17" cloud-drift="dist: 6; dur: 17000">
        <a-sphere position="0 0 0" radius="1.0" color="#EDEDED" opacity="0.9"></a-sphere>
        <a-sphere position="0.7 0.1 0.3" radius="0.7" color="#E6E6E6" opacity="0.9"></a-sphere>
        <a-sphere position="-0.6 0.15 -0.1" radius="0.6" color="#F2F2F2" opacity="0.9"></a-sphere>
      </a-entity>
      <a-entity position="-3 6 -20" cloud-drift="dist: 7; dur: 19000">
        <a-sphere position="0 0 0" radius="1.3" color="#EAEAEA" opacity="0.9"></a-sphere>
        <a-sphere position="1 0.2 0.3" radius="0.7" color="#F4F4F4" opacity="0.9"></a-sphere>
      </a-entity>

      <!-- birds -->
      <a-entity bird-flight="fromX: -9; toX: 9; y: 5.5; z: -14; dur: 8500">
        <a-triangle color="#222" vertex-a="0 0 0" vertex-b="0.3 0.1 0" vertex-c="0 -0.1 0"></a-triangle>
        <a-triangle color="#222" vertex-a="0 0 0" vertex-b="-0.3 0.1 0" vertex-c="0 -0.1 0"></a-triangle>
      </a-entity>
      <a-entity bird-flight="fromX: 10; toX: -6; y: 4.2; z: -11; dur: 10500">
        <a-triangle color="#333" vertex-a="0 0 0" vertex-b="0.25 0.08 0" vertex-c="0 -0.08 0"></a-triangle>
        <a-triangle color="#333" vertex-a="0 0 0" vertex-b="-0.25 0.08 0" vertex-c="0 -0.08 0"></a-triangle>
      </a-entity>
      <a-entity bird-flight="fromX: -8; toX: 5; y: 6.8; z: -19; dur: 12000">
        <a-triangle color="#111" vertex-a="0 0 0" vertex-b="0.35 0.1 0" vertex-c="0 -0.12 0"></a-triangle>
        <a-triangle color="#111" vertex-a="0 0 0" vertex-b="-0.35 0.1 0" vertex-c="0 -0.12 0"></a-triangle>
      </a-entity>
      <a-entity bird-flight="fromX: 5; toX: -5; y: 3.7; z: -9; dur: 9500">
        <a-triangle color="#000" vertex-a="0 0 0" vertex-b="0.22 0.06 0" vertex-c="0 -0.06 0"></a-triangle>
        <a-triangle color="#000" vertex-a="0 0 0" vertex-b="-0.22 0.06 0" vertex-c="0 -0.06 0"></a-triangle>
      </a-entity>

      <!-- spinning cube with texture -->
      <a-box position="-1 0.5 -4"
             src="#minecraft"
             depth="0.6"
             height="0.6"
             width="0.6"
             shadow="cast: true"
             animation="property: rotation; to: 0 360 0; loop: true; dur: 9000; easing: linear">
      </a-box>

      <a-entity position="0 1.6 0" camera look-controls></a-entity>
    </a-scene>
  </body>
</html>